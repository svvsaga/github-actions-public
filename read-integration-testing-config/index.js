var Ue=Object.create;var x=Object.defineProperty,De=Object.defineProperties,je=Object.getOwnPropertyDescriptor,Me=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertyNames,Q=Object.getOwnPropertySymbols,$e=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var W=(e,t,r)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,X=(e,t)=>{for(var r in t||(t={}))Y.call(t,r)&&W(e,r,t[r]);if(Q)for(var r of Q(t))Le.call(t,r)&&W(e,r,t[r]);return e},H=(e,t)=>De(e,Me(t)),Z=e=>x(e,"__esModule",{value:!0});var w=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Fe=(e,t)=>{for(var r in t)x(e,r,{get:t[r],enumerable:!0})},ee=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Be(t))!Y.call(e,s)&&(r||s!=="default")&&x(e,s,{get:()=>t[s],enumerable:!(n=je(t,s))||n.enumerable});return e},te=(e,t)=>ee(Z(x(e!=null?Ue($e(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),Ge=(e=>(t,r)=>e&&e.get(t)||(r=ee(Z({}),t,1),e&&e.set(t,r),r))(typeof WeakMap!="undefined"?new WeakMap:0);var U=w(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.toCommandProperties=T.toCommandValue=void 0;function Je(e){return e==null?"":typeof e=="string"||e instanceof String?e:JSON.stringify(e)}T.toCommandValue=Je;function Ve(e){return Object.keys(e).length?{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}:{}}T.toCommandProperties=Ve});var ie=w(m=>{"use strict";var ze=m&&m.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ke=m&&m.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Qe=m&&m.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&ze(t,e,r);return Ke(t,e),t};Object.defineProperty(m,"__esModule",{value:!0});m.issue=m.issueCommand=void 0;var Ye=Qe(require("os")),re=U();function ne(e,t,r){let n=new oe(e,t,r);process.stdout.write(n.toString()+Ye.EOL)}m.issueCommand=ne;function We(e,t=""){ne(e,{},t)}m.issue=We;var se="::",oe=class{constructor(t,r,n){t||(t="missing.command"),this.command=t,this.properties=r,this.message=n}toString(){let t=se+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let r=!0;for(let n in this.properties)if(this.properties.hasOwnProperty(n)){let s=this.properties[n];s&&(r?r=!1:t+=",",t+=`${n}=${He(s)}`)}}return t+=`${se}${Xe(this.message)}`,t}};function Xe(e){return re.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function He(e){return re.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var ce=w(O=>{"use strict";var Ze=O&&O.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),et=O&&O.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ae=O&&O.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Ze(t,e,r);return et(t,e),t};Object.defineProperty(O,"__esModule",{value:!0});O.issueCommand=void 0;var ue=ae(require("fs")),tt=ae(require("os")),rt=U();function nt(e,t){let r=process.env[`GITHUB_${e}`];if(!r)throw new Error(`Unable to find environment variable for file command ${e}`);if(!ue.existsSync(r))throw new Error(`Missing file at path: ${r}`);ue.appendFileSync(r,`${rt.toCommandValue(t)}${tt.EOL}`,{encoding:"utf8"})}O.issueCommand=nt});var fe=w(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});function st(e){let t=e.protocol==="https:",r;if(le(e))return r;let n;return t?n=process.env.https_proxy||process.env.HTTPS_PROXY:n=process.env.http_proxy||process.env.HTTP_PROXY,n&&(r=new URL(n)),r}D.getProxyUrl=st;function le(e){if(!e.hostname)return!1;let t=process.env.no_proxy||process.env.NO_PROXY||"";if(!t)return!1;let r;e.port?r=Number(e.port):e.protocol==="http:"?r=80:e.protocol==="https:"&&(r=443);let n=[e.hostname.toUpperCase()];typeof r=="number"&&n.push(`${n[0]}:${r}`);for(let s of t.split(",").map(o=>o.trim().toUpperCase()).filter(o=>o))if(n.some(o=>o===s))return!0;return!1}D.checkBypass=le});var ge=w(P=>{"use strict";var Yt=require("net"),ot=require("tls"),F=require("http"),pe=require("https"),it=require("events"),Wt=require("assert"),at=require("util");P.httpOverHttp=ut;P.httpsOverHttp=ct;P.httpOverHttps=lt;P.httpsOverHttps=ft;function ut(e){var t=new R(e);return t.request=F.request,t}function ct(e){var t=new R(e);return t.request=F.request,t.createSocket=de,t.defaultPort=443,t}function lt(e){var t=new R(e);return t.request=pe.request,t}function ft(e){var t=new R(e);return t.request=pe.request,t.createSocket=de,t.defaultPort=443,t}function R(e){var t=this;t.options=e||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||F.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",function(n,s,o,i){for(var u=he(s,o,i),c=0,l=t.requests.length;c<l;++c){var f=t.requests[c];if(f.host===u.host&&f.port===u.port){t.requests.splice(c,1),f.request.onSocket(n);return}}n.destroy(),t.removeSocket(n)})}at.inherits(R,it.EventEmitter);R.prototype.addRequest=function(t,r,n,s){var o=this,i=G({request:t},o.options,he(r,n,s));if(o.sockets.length>=this.maxSockets){o.requests.push(i);return}o.createSocket(i,function(u){u.on("free",c),u.on("close",l),u.on("agentRemove",l),t.onSocket(u);function c(){o.emit("free",u,i)}function l(f){o.removeSocket(u),u.removeListener("free",c),u.removeListener("close",l),u.removeListener("agentRemove",l)}})};R.prototype.createSocket=function(t,r){var n=this,s={};n.sockets.push(s);var o=G({},n.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:!1,headers:{host:t.host+":"+t.port}});t.localAddress&&(o.localAddress=t.localAddress),o.proxyAuth&&(o.headers=o.headers||{},o.headers["Proxy-Authorization"]="Basic "+new Buffer(o.proxyAuth).toString("base64")),S("making CONNECT request");var i=n.request(o);i.useChunkedEncodingByDefault=!1,i.once("response",u),i.once("upgrade",c),i.once("connect",l),i.once("error",f),i.end();function u(p){p.upgrade=!0}function c(p,d,A){process.nextTick(function(){l(p,d,A)})}function l(p,d,A){if(i.removeAllListeners(),d.removeAllListeners(),p.statusCode!==200){S("tunneling socket could not be established, statusCode=%d",p.statusCode),d.destroy();var I=new Error("tunneling socket could not be established, statusCode="+p.statusCode);I.code="ECONNRESET",t.request.emit("error",I),n.removeSocket(s);return}if(A.length>0){S("got illegal response body from proxy"),d.destroy();var I=new Error("got illegal response body from proxy");I.code="ECONNRESET",t.request.emit("error",I),n.removeSocket(s);return}return S("tunneling connection has established"),n.sockets[n.sockets.indexOf(s)]=d,r(d)}function f(p){i.removeAllListeners(),S(`tunneling socket could not be established, cause=%s
`,p.message,p.stack);var d=new Error("tunneling socket could not be established, cause="+p.message);d.code="ECONNRESET",t.request.emit("error",d),n.removeSocket(s)}};R.prototype.removeSocket=function(t){var r=this.sockets.indexOf(t);if(r!==-1){this.sockets.splice(r,1);var n=this.requests.shift();n&&this.createSocket(n,function(s){n.request.onSocket(s)})}};function de(e,t){var r=this;R.prototype.createSocket.call(r,e,function(n){var s=e.request.getHeader("host"),o=G({},r.options,{socket:n,servername:s?s.replace(/:.*$/,""):e.host}),i=ot.connect(0,o);r.sockets[r.sockets.indexOf(n)]=i,t(i)})}function he(e,t,r){return typeof e=="string"?{host:e,port:t,localAddress:r}:e}function G(e){for(var t=1,r=arguments.length;t<r;++t){var n=arguments[t];if(typeof n=="object")for(var s=Object.keys(n),o=0,i=s.length;o<i;++o){var u=s[o];n[u]!==void 0&&(e[u]=n[u])}}return e}var S;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?S=function(){var e=Array.prototype.slice.call(arguments);typeof e[0]=="string"?e[0]="TUNNEL: "+e[0]:e.unshift("TUNNEL:"),console.error.apply(console,e)}:S=function(){};P.debug=S});var ve=w((Ht,me)=>{me.exports=ge()});var ye=w(g=>{"use strict";Object.defineProperty(g,"__esModule",{value:!0});var j=require("http"),J=require("https"),_e=fe(),q,y;(function(e){e[e.OK=200]="OK",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.ResourceMoved=302]="ResourceMoved",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.SwitchProxy=306]="SwitchProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"})(y=g.HttpCodes||(g.HttpCodes={}));var h;(function(e){e.Accept="accept",e.ContentType="content-type"})(h=g.Headers||(g.Headers={}));var E;(function(e){e.ApplicationJson="application/json"})(E=g.MediaTypes||(g.MediaTypes={}));function pt(e){let t=_e.getProxyUrl(new URL(e));return t?t.href:""}g.getProxyUrl=pt;var dt=[y.MovedPermanently,y.ResourceMoved,y.SeeOther,y.TemporaryRedirect,y.PermanentRedirect],ht=[y.BadGateway,y.ServiceUnavailable,y.GatewayTimeout],gt=["OPTIONS","GET","DELETE","HEAD"],mt=10,vt=5,C=class extends Error{constructor(t,r){super(t);this.name="HttpClientError",this.statusCode=r,Object.setPrototypeOf(this,C.prototype)}};g.HttpClientError=C;var V=class{constructor(t){this.message=t}readBody(){return new Promise(async(t,r)=>{let n=Buffer.alloc(0);this.message.on("data",s=>{n=Buffer.concat([n,s])}),this.message.on("end",()=>{t(n.toString())})})}};g.HttpClientResponse=V;function _t(e){return new URL(e).protocol==="https:"}g.isHttps=_t;var M=class{constructor(t,r,n){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=t,this.handlers=r||[],this.requestOptions=n,n&&(n.ignoreSslError!=null&&(this._ignoreSslError=n.ignoreSslError),this._socketTimeout=n.socketTimeout,n.allowRedirects!=null&&(this._allowRedirects=n.allowRedirects),n.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=n.allowRedirectDowngrade),n.maxRedirects!=null&&(this._maxRedirects=Math.max(n.maxRedirects,0)),n.keepAlive!=null&&(this._keepAlive=n.keepAlive),n.allowRetries!=null&&(this._allowRetries=n.allowRetries),n.maxRetries!=null&&(this._maxRetries=n.maxRetries))}options(t,r){return this.request("OPTIONS",t,null,r||{})}get(t,r){return this.request("GET",t,null,r||{})}del(t,r){return this.request("DELETE",t,null,r||{})}post(t,r,n){return this.request("POST",t,r,n||{})}patch(t,r,n){return this.request("PATCH",t,r,n||{})}put(t,r,n){return this.request("PUT",t,r,n||{})}head(t,r){return this.request("HEAD",t,null,r||{})}sendStream(t,r,n,s){return this.request(t,r,n,s)}async getJson(t,r={}){r[h.Accept]=this._getExistingOrDefaultHeader(r,h.Accept,E.ApplicationJson);let n=await this.get(t,r);return this._processResponse(n,this.requestOptions)}async postJson(t,r,n={}){let s=JSON.stringify(r,null,2);n[h.Accept]=this._getExistingOrDefaultHeader(n,h.Accept,E.ApplicationJson),n[h.ContentType]=this._getExistingOrDefaultHeader(n,h.ContentType,E.ApplicationJson);let o=await this.post(t,s,n);return this._processResponse(o,this.requestOptions)}async putJson(t,r,n={}){let s=JSON.stringify(r,null,2);n[h.Accept]=this._getExistingOrDefaultHeader(n,h.Accept,E.ApplicationJson),n[h.ContentType]=this._getExistingOrDefaultHeader(n,h.ContentType,E.ApplicationJson);let o=await this.put(t,s,n);return this._processResponse(o,this.requestOptions)}async patchJson(t,r,n={}){let s=JSON.stringify(r,null,2);n[h.Accept]=this._getExistingOrDefaultHeader(n,h.Accept,E.ApplicationJson),n[h.ContentType]=this._getExistingOrDefaultHeader(n,h.ContentType,E.ApplicationJson);let o=await this.patch(t,s,n);return this._processResponse(o,this.requestOptions)}async request(t,r,n,s){if(this._disposed)throw new Error("Client has already been disposed.");let o=new URL(r),i=this._prepareRequest(t,o,s),u=this._allowRetries&&gt.indexOf(t)!=-1?this._maxRetries+1:1,c=0,l;for(;c<u;){if(l=await this.requestRaw(i,n),l&&l.message&&l.message.statusCode===y.Unauthorized){let p;for(let d=0;d<this.handlers.length;d++)if(this.handlers[d].canHandleAuthentication(l)){p=this.handlers[d];break}return p?p.handleAuthentication(this,i,n):l}let f=this._maxRedirects;for(;dt.indexOf(l.message.statusCode)!=-1&&this._allowRedirects&&f>0;){let p=l.message.headers.location;if(!p)break;let d=new URL(p);if(o.protocol=="https:"&&o.protocol!=d.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(await l.readBody(),d.hostname!==o.hostname)for(let A in s)A.toLowerCase()==="authorization"&&delete s[A];i=this._prepareRequest(t,d,s),l=await this.requestRaw(i,n),f--}if(ht.indexOf(l.message.statusCode)==-1)return l;c+=1,c<u&&(await l.readBody(),await this._performExponentialBackoff(c))}return l}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(t,r){return new Promise((n,s)=>{let o=function(i,u){i&&s(i),n(u)};this.requestRawWithCallback(t,r,o)})}requestRawWithCallback(t,r,n){let s;typeof r=="string"&&(t.options.headers["Content-Length"]=Buffer.byteLength(r,"utf8"));let o=!1,i=(c,l)=>{o||(o=!0,n(c,l))},u=t.httpModule.request(t.options,c=>{let l=new V(c);i(null,l)});u.on("socket",c=>{s=c}),u.setTimeout(this._socketTimeout||3*6e4,()=>{s&&s.end(),i(new Error("Request timeout: "+t.options.path),null)}),u.on("error",function(c){i(c,null)}),r&&typeof r=="string"&&u.write(r,"utf8"),r&&typeof r!="string"?(r.on("close",function(){u.end()}),r.pipe(u)):u.end()}getAgent(t){let r=new URL(t);return this._getAgent(r)}_prepareRequest(t,r,n){let s={};s.parsedUrl=r;let o=s.parsedUrl.protocol==="https:";s.httpModule=o?J:j;let i=o?443:80;return s.options={},s.options.host=s.parsedUrl.hostname,s.options.port=s.parsedUrl.port?parseInt(s.parsedUrl.port):i,s.options.path=(s.parsedUrl.pathname||"")+(s.parsedUrl.search||""),s.options.method=t,s.options.headers=this._mergeHeaders(n),this.userAgent!=null&&(s.options.headers["user-agent"]=this.userAgent),s.options.agent=this._getAgent(s.parsedUrl),this.handlers&&this.handlers.forEach(u=>{u.prepareRequest(s.options)}),s}_mergeHeaders(t){let r=n=>Object.keys(n).reduce((s,o)=>(s[o.toLowerCase()]=n[o],s),{});return this.requestOptions&&this.requestOptions.headers?Object.assign({},r(this.requestOptions.headers),r(t)):r(t||{})}_getExistingOrDefaultHeader(t,r,n){let s=i=>Object.keys(i).reduce((u,c)=>(u[c.toLowerCase()]=i[c],u),{}),o;return this.requestOptions&&this.requestOptions.headers&&(o=s(this.requestOptions.headers)[r]),t[r]||o||n}_getAgent(t){let r,n=_e.getProxyUrl(t),s=n&&n.hostname;if(this._keepAlive&&s&&(r=this._proxyAgent),this._keepAlive&&!s&&(r=this._agent),r)return r;let o=t.protocol==="https:",i=100;if(this.requestOptions&&(i=this.requestOptions.maxSockets||j.globalAgent.maxSockets),s){q||(q=ve());let u={maxSockets:i,keepAlive:this._keepAlive,proxy:H(X({},(n.username||n.password)&&{proxyAuth:`${n.username}:${n.password}`}),{host:n.hostname,port:n.port})},c,l=n.protocol==="https:";o?c=l?q.httpsOverHttps:q.httpsOverHttp:c=l?q.httpOverHttps:q.httpOverHttp,r=c(u),this._proxyAgent=r}if(this._keepAlive&&!r){let u={keepAlive:this._keepAlive,maxSockets:i};r=o?new J.Agent(u):new j.Agent(u),this._agent=r}return r||(r=o?J.globalAgent:j.globalAgent),o&&this._ignoreSslError&&(r.options=Object.assign(r.options||{},{rejectUnauthorized:!1})),r}_performExponentialBackoff(t){t=Math.min(mt,t);let r=vt*Math.pow(2,t);return new Promise(n=>setTimeout(()=>n(),r))}static dateTimeDeserializer(t,r){if(typeof r=="string"){let n=new Date(r);if(!isNaN(n.valueOf()))return n}return r}async _processResponse(t,r){return new Promise(async(n,s)=>{let o=t.message.statusCode,i={statusCode:o,result:null,headers:{}};o==y.NotFound&&n(i);let u,c;try{c=await t.readBody(),c&&c.length>0&&(r&&r.deserializeDates?u=JSON.parse(c,M.dateTimeDeserializer):u=JSON.parse(c),i.result=u),i.headers=t.message.headers}catch{}if(o>299){let l;u&&u.message?l=u.message:c&&c.length>0?l=c:l="Failed request: ("+o+")";let f=new C(l,o);f.result=i.result,s(f)}else n(i)})}};g.HttpClient=M});var Se=w(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});var we=class{constructor(t,r){this.username=t,this.password=r}prepareRequest(t){t.headers.Authorization="Basic "+Buffer.from(this.username+":"+this.password).toString("base64")}canHandleAuthentication(t){return!1}handleAuthentication(t,r,n){return null}};N.BasicCredentialHandler=we;var Oe=class{constructor(t){this.token=t}prepareRequest(t){t.headers.Authorization="Bearer "+this.token}canHandleAuthentication(t){return!1}handleAuthentication(t,r,n){return null}};N.BearerCredentialHandler=Oe;var Re=class{constructor(t){this.token=t}prepareRequest(t){t.headers.Authorization="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(t){return!1}handleAuthentication(t,r,n){return null}};N.PersonalAccessTokenCredentialHandler=Re});var Ae=w(k=>{"use strict";var Ee=k&&k.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function u(f){try{l(n.next(f))}catch(p){i(p)}}function c(f){try{l(n.throw(f))}catch(p){i(p)}}function l(f){f.done?o(f.value):s(f.value).then(u,c)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(k,"__esModule",{value:!0});k.OidcClient=void 0;var yt=ye(),wt=Se(),be=z(),b=class{static createHttpClient(t=!0,r=10){let n={allowRetries:t,maxRetries:r};return new yt.HttpClient("actions/oidc-client",[new wt.BearerCredentialHandler(b.getRequestToken())],n)}static getRequestToken(){let t=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return t}static getIDTokenUrl(){let t=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return t}static getCall(t){var r;return Ee(this,void 0,void 0,function*(){let o=(r=(yield b.createHttpClient().getJson(t).catch(i=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${i.statusCode}
 
        Error Message: ${i.result.message}`)})).result)===null||r===void 0?void 0:r.value;if(!o)throw new Error("Response json body do not have ID Token field");return o})}static getIDToken(t){return Ee(this,void 0,void 0,function*(){try{let r=b.getIDTokenUrl();if(t){let s=encodeURIComponent(t);r=`${r}&audience=${s}`}be.debug(`ID token url is ${r}`);let n=yield b.getCall(r);return be.setSecret(n),n}catch(r){throw new Error(`Error message: ${r.message}`)}})}};k.OidcClient=b});var z=w(a=>{"use strict";var Ot=a&&a.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Rt=a&&a.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Te=a&&a.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Ot(t,e,r);return Rt(t,e),t},Pe=a&&a.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function u(f){try{l(n.next(f))}catch(p){i(p)}}function c(f){try{l(n.throw(f))}catch(p){i(p)}}function l(f){f.done?o(f.value):s(f.value).then(u,c)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(a,"__esModule",{value:!0});a.getIDToken=a.getState=a.saveState=a.group=a.endGroup=a.startGroup=a.info=a.notice=a.warning=a.error=a.debug=a.isDebug=a.setFailed=a.setCommandEcho=a.setOutput=a.getBooleanInput=a.getMultilineInput=a.getInput=a.addPath=a.setSecret=a.exportVariable=a.ExitCode=void 0;var v=ie(),qe=ce(),B=U(),$=Te(require("os")),St=Te(require("path")),Et=Ae(),ke;(function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"})(ke=a.ExitCode||(a.ExitCode={}));function bt(e,t){let r=B.toCommandValue(t);if(process.env[e]=r,process.env.GITHUB_ENV||""){let s="_GitHubActionsFileCommandDelimeter_",o=`${e}<<${s}${$.EOL}${r}${$.EOL}${s}`;qe.issueCommand("ENV",o)}else v.issueCommand("set-env",{name:e},r)}a.exportVariable=bt;function At(e){v.issueCommand("add-mask",{},e)}a.setSecret=At;function Tt(e){process.env.GITHUB_PATH||""?qe.issueCommand("PATH",e):v.issueCommand("add-path",{},e),process.env.PATH=`${e}${St.delimiter}${process.env.PATH}`}a.addPath=Tt;function K(e,t){let r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r)throw new Error(`Input required and not supplied: ${e}`);return t&&t.trimWhitespace===!1?r:r.trim()}a.getInput=K;function Pt(e,t){return K(e,t).split(`
`).filter(n=>n!=="")}a.getMultilineInput=Pt;function qt(e,t){let r=["true","True","TRUE"],n=["false","False","FALSE"],s=K(e,t);if(r.includes(s))return!0;if(n.includes(s))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}a.getBooleanInput=qt;function kt(e,t){process.stdout.write($.EOL),v.issueCommand("set-output",{name:e},t)}a.setOutput=kt;function It(e){v.issue("echo",e?"on":"off")}a.setCommandEcho=It;function xt(e){process.exitCode=ke.Failure,Ie(e)}a.setFailed=xt;function Ct(){return process.env.RUNNER_DEBUG==="1"}a.isDebug=Ct;function Nt(e){v.issueCommand("debug",{},e)}a.debug=Nt;function Ie(e,t={}){v.issueCommand("error",B.toCommandProperties(t),e instanceof Error?e.toString():e)}a.error=Ie;function Ut(e,t={}){v.issueCommand("warning",B.toCommandProperties(t),e instanceof Error?e.toString():e)}a.warning=Ut;function Dt(e,t={}){v.issueCommand("notice",B.toCommandProperties(t),e instanceof Error?e.toString():e)}a.notice=Dt;function jt(e){process.stdout.write(e+$.EOL)}a.info=jt;function xe(e){v.issue("group",e)}a.startGroup=xe;function Ce(){v.issue("endgroup")}a.endGroup=Ce;function Mt(e,t){return Pe(this,void 0,void 0,function*(){xe(e);let r;try{r=yield t()}finally{Ce()}return r})}a.group=Mt;function Bt(e,t){v.issueCommand("save-state",{name:e},t)}a.saveState=Bt;function $t(e){return process.env[`STATE_${e}`]||""}a.getState=$t;function Lt(e){return Pe(this,void 0,void 0,function*(){return yield Et.OidcClient.getIDToken(e)})}a.getIDToken=Lt});var Gt={};Fe(Gt,{readIntTestingConfig:()=>Ne});var _=te(z()),L=te(require("fs"));async function Ne(e,t){let r,n,s="SHARED",o="project-service-account",i=`${e}/${t}`;if(L.existsSync(i)){let u=L.readFileSync(i,"utf-8"),c=JSON.parse(u);return c.workloadIdentityProjectId&&(r=c.workloadIdentityProjectId),c.workloadIdentityProjectNumber&&(n=c.workloadIdentityProjectNumber),c.environment&&(s=c.environment),c.serviceAccount&&(o=c.serviceAccount),{environment:s,workloadIdentityProjectId:r,workloadIdentityProjectNumber:n,serviceAccount:o}}else return _.info(`No ${t} found. Unable to run integration tests.`),null}async function Ft(){try{let e=_.getInput("cwd"),t=await Ne(e,"inttest.config.json");if(!t)_.setFailed("No integration testing config file found");else{let{environment:r,workloadIdentityProjectId:n,workloadIdentityProjectNumber:s,serviceAccount:o}=t;r&&_.setOutput("environment",r),n&&_.setOutput("workload_identity_project_id",n),s&&_.setOutput("workload_identity_project_number",s),_.setOutput("service_account",o)}}catch(e){_.setFailed(e)}}Ft();module.exports=Ge(Gt);0&&(module.exports={readIntTestingConfig});
