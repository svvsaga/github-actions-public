var Ke=Object.create;var B=Object.defineProperty,Ye=Object.defineProperties,We=Object.getOwnPropertyDescriptor,Qe=Object.getOwnPropertyDescriptors,Xe=Object.getOwnPropertyNames,ie=Object.getOwnPropertySymbols,He=Object.getPrototypeOf,oe=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var ae=(t,e,r)=>e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,N=(t,e)=>{for(var r in e||(e={}))oe.call(e,r)&&ae(t,r,e[r]);if(ie)for(var r of ie(e))Ze.call(e,r)&&ae(t,r,e[r]);return t},k=(t,e)=>Ye(t,Qe(e)),et=t=>B(t,"__esModule",{value:!0});var _=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var tt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Xe(e))!oe.call(t,s)&&(r||s!=="default")&&B(t,s,{get:()=>e[s],enumerable:!(n=We(e,s))||n.enumerable});return t},A=(t,e)=>tt(et(B(t!=null?Ke(He(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var L=_(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.toCommandProperties=P.toCommandValue=void 0;function rt(t){return t==null?"":typeof t=="string"||t instanceof String?t:JSON.stringify(t)}P.toCommandValue=rt;function nt(t){return Object.keys(t).length?{title:t.title,file:t.file,line:t.startLine,endLine:t.endLine,col:t.startColumn,endColumn:t.endColumn}:{}}P.toCommandProperties=nt});var pe=_(g=>{"use strict";var st=g&&g.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),it=g&&g.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ot=g&&g.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&st(e,t,r);return it(e,t),e};Object.defineProperty(g,"__esModule",{value:!0});g.issue=g.issueCommand=void 0;var at=ot(require("os")),ue=L();function ce(t,e,r){let n=new fe(t,e,r);process.stdout.write(n.toString()+at.EOL)}g.issueCommand=ce;function ut(t,e=""){ce(t,{},e)}g.issue=ut;var le="::",fe=class{constructor(e,r,n){e||(e="missing.command"),this.command=e,this.properties=r,this.message=n}toString(){let e=le+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let r=!0;for(let n in this.properties)if(this.properties.hasOwnProperty(n)){let s=this.properties[n];s&&(r?r=!1:e+=",",e+=`${n}=${lt(s)}`)}}return e+=`${le}${ct(this.message)}`,e}};function ct(t){return ue.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function lt(t){return ue.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var me=_(w=>{"use strict";var ft=w&&w.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),pt=w&&w.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),he=w&&w.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&ft(e,t,r);return pt(e,t),e};Object.defineProperty(w,"__esModule",{value:!0});w.issueCommand=void 0;var de=he(require("fs")),ht=he(require("os")),dt=L();function mt(t,e){let r=process.env[`GITHUB_${t}`];if(!r)throw new Error(`Unable to find environment variable for file command ${t}`);if(!de.existsSync(r))throw new Error(`Missing file at path: ${r}`);de.appendFileSync(r,`${dt.toCommandValue(e)}${ht.EOL}`,{encoding:"utf8"})}w.issueCommand=mt});var ve=_($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});function gt(t){let e=t.protocol==="https:",r;if(ge(t))return r;let n;return e?n=process.env.https_proxy||process.env.HTTPS_PROXY:n=process.env.http_proxy||process.env.HTTP_PROXY,n&&(r=new URL(n)),r}$.getProxyUrl=gt;function ge(t){if(!t.hostname)return!1;let e=process.env.no_proxy||process.env.NO_PROXY||"";if(!e)return!1;let r;t.port?r=Number(t.port):t.protocol==="http:"?r=80:t.protocol==="https:"&&(r=443);let n=[t.hostname.toUpperCase()];typeof r=="number"&&n.push(`${n[0]}:${r}`);for(let s of e.split(",").map(i=>i.trim().toUpperCase()).filter(i=>i))if(n.some(i=>i===s))return!0;return!1}$.checkBypass=ge});var Se=_(x=>{"use strict";var hr=require("net"),vt=require("tls"),W=require("http"),ye=require("https"),yt=require("events"),dr=require("assert"),_t=require("util");x.httpOverHttp=wt;x.httpsOverHttp=St;x.httpOverHttps=Et;x.httpsOverHttps=Tt;function wt(t){var e=new S(t);return e.request=W.request,e}function St(t){var e=new S(t);return e.request=W.request,e.createSocket=_e,e.defaultPort=443,e}function Et(t){var e=new S(t);return e.request=ye.request,e}function Tt(t){var e=new S(t);return e.request=ye.request,e.createSocket=_e,e.defaultPort=443,e}function S(t){var e=this;e.options=t||{},e.proxyOptions=e.options.proxy||{},e.maxSockets=e.options.maxSockets||W.Agent.defaultMaxSockets,e.requests=[],e.sockets=[],e.on("free",function(n,s,i,a){for(var o=we(s,i,a),l=0,u=e.requests.length;l<u;++l){var f=e.requests[l];if(f.host===o.host&&f.port===o.port){e.requests.splice(l,1),f.request.onSocket(n);return}}n.destroy(),e.removeSocket(n)})}_t.inherits(S,yt.EventEmitter);S.prototype.addRequest=function(e,r,n,s){var i=this,a=Q({request:e},i.options,we(r,n,s));if(i.sockets.length>=this.maxSockets){i.requests.push(a);return}i.createSocket(a,function(o){o.on("free",l),o.on("close",u),o.on("agentRemove",u),e.onSocket(o);function l(){i.emit("free",o,a)}function u(f){i.removeSocket(o),o.removeListener("free",l),o.removeListener("close",u),o.removeListener("agentRemove",u)}})};S.prototype.createSocket=function(e,r){var n=this,s={};n.sockets.push(s);var i=Q({},n.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:!1,headers:{host:e.host+":"+e.port}});e.localAddress&&(i.localAddress=e.localAddress),i.proxyAuth&&(i.headers=i.headers||{},i.headers["Proxy-Authorization"]="Basic "+new Buffer(i.proxyAuth).toString("base64")),E("making CONNECT request");var a=n.request(i);a.useChunkedEncodingByDefault=!1,a.once("response",o),a.once("upgrade",l),a.once("connect",u),a.once("error",f),a.end();function o(p){p.upgrade=!0}function l(p,h,R){process.nextTick(function(){u(p,h,R)})}function u(p,h,R){if(a.removeAllListeners(),h.removeAllListeners(),p.statusCode!==200){E("tunneling socket could not be established, statusCode=%d",p.statusCode),h.destroy();var C=new Error("tunneling socket could not be established, statusCode="+p.statusCode);C.code="ECONNRESET",e.request.emit("error",C),n.removeSocket(s);return}if(R.length>0){E("got illegal response body from proxy"),h.destroy();var C=new Error("got illegal response body from proxy");C.code="ECONNRESET",e.request.emit("error",C),n.removeSocket(s);return}return E("tunneling connection has established"),n.sockets[n.sockets.indexOf(s)]=h,r(h)}function f(p){a.removeAllListeners(),E(`tunneling socket could not be established, cause=%s
`,p.message,p.stack);var h=new Error("tunneling socket could not be established, cause="+p.message);h.code="ECONNRESET",e.request.emit("error",h),n.removeSocket(s)}};S.prototype.removeSocket=function(e){var r=this.sockets.indexOf(e);if(r!==-1){this.sockets.splice(r,1);var n=this.requests.shift();n&&this.createSocket(n,function(s){n.request.onSocket(s)})}};function _e(t,e){var r=this;S.prototype.createSocket.call(r,t,function(n){var s=t.request.getHeader("host"),i=Q({},r.options,{socket:n,servername:s?s.replace(/:.*$/,""):t.host}),a=vt.connect(0,i);r.sockets[r.sockets.indexOf(n)]=a,e(a)})}function we(t,e,r){return typeof t=="string"?{host:t,port:e,localAddress:r}:t}function Q(t){for(var e=1,r=arguments.length;e<r;++e){var n=arguments[e];if(typeof n=="object")for(var s=Object.keys(n),i=0,a=s.length;i<a;++i){var o=s[i];n[o]!==void 0&&(t[o]=n[o])}}return t}var E;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?E=function(){var t=Array.prototype.slice.call(arguments);typeof t[0]=="string"?t[0]="TUNNEL: "+t[0]:t.unshift("TUNNEL:"),console.error.apply(console,t)}:E=function(){};x.debug=E});var Te=_((gr,Ee)=>{Ee.exports=Se()});var be=_(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var j=require("http"),X=require("https"),Oe=ve(),q,y;(function(t){t[t.OK=200]="OK",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.ResourceMoved=302]="ResourceMoved",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.SwitchProxy=306]="SwitchProxy",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.TooManyRequests=429]="TooManyRequests",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout"})(y=m.HttpCodes||(m.HttpCodes={}));var d;(function(t){t.Accept="accept",t.ContentType="content-type"})(d=m.Headers||(m.Headers={}));var T;(function(t){t.ApplicationJson="application/json"})(T=m.MediaTypes||(m.MediaTypes={}));function Ot(t){let e=Oe.getProxyUrl(new URL(t));return e?e.href:""}m.getProxyUrl=Ot;var bt=[y.MovedPermanently,y.ResourceMoved,y.SeeOther,y.TemporaryRedirect,y.PermanentRedirect],Rt=[y.BadGateway,y.ServiceUnavailable,y.GatewayTimeout],At=["OPTIONS","GET","DELETE","HEAD"],Pt=10,xt=5,D=class extends Error{constructor(e,r){super(e);this.name="HttpClientError",this.statusCode=r,Object.setPrototypeOf(this,D.prototype)}};m.HttpClientError=D;var H=class{constructor(e){this.message=e}readBody(){return new Promise(async(e,r)=>{let n=Buffer.alloc(0);this.message.on("data",s=>{n=Buffer.concat([n,s])}),this.message.on("end",()=>{e(n.toString())})})}};m.HttpClientResponse=H;function qt(t){return new URL(t).protocol==="https:"}m.isHttps=qt;var F=class{constructor(e,r,n){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=e,this.handlers=r||[],this.requestOptions=n,n&&(n.ignoreSslError!=null&&(this._ignoreSslError=n.ignoreSslError),this._socketTimeout=n.socketTimeout,n.allowRedirects!=null&&(this._allowRedirects=n.allowRedirects),n.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=n.allowRedirectDowngrade),n.maxRedirects!=null&&(this._maxRedirects=Math.max(n.maxRedirects,0)),n.keepAlive!=null&&(this._keepAlive=n.keepAlive),n.allowRetries!=null&&(this._allowRetries=n.allowRetries),n.maxRetries!=null&&(this._maxRetries=n.maxRetries))}options(e,r){return this.request("OPTIONS",e,null,r||{})}get(e,r){return this.request("GET",e,null,r||{})}del(e,r){return this.request("DELETE",e,null,r||{})}post(e,r,n){return this.request("POST",e,r,n||{})}patch(e,r,n){return this.request("PATCH",e,r,n||{})}put(e,r,n){return this.request("PUT",e,r,n||{})}head(e,r){return this.request("HEAD",e,null,r||{})}sendStream(e,r,n,s){return this.request(e,r,n,s)}async getJson(e,r={}){r[d.Accept]=this._getExistingOrDefaultHeader(r,d.Accept,T.ApplicationJson);let n=await this.get(e,r);return this._processResponse(n,this.requestOptions)}async postJson(e,r,n={}){let s=JSON.stringify(r,null,2);n[d.Accept]=this._getExistingOrDefaultHeader(n,d.Accept,T.ApplicationJson),n[d.ContentType]=this._getExistingOrDefaultHeader(n,d.ContentType,T.ApplicationJson);let i=await this.post(e,s,n);return this._processResponse(i,this.requestOptions)}async putJson(e,r,n={}){let s=JSON.stringify(r,null,2);n[d.Accept]=this._getExistingOrDefaultHeader(n,d.Accept,T.ApplicationJson),n[d.ContentType]=this._getExistingOrDefaultHeader(n,d.ContentType,T.ApplicationJson);let i=await this.put(e,s,n);return this._processResponse(i,this.requestOptions)}async patchJson(e,r,n={}){let s=JSON.stringify(r,null,2);n[d.Accept]=this._getExistingOrDefaultHeader(n,d.Accept,T.ApplicationJson),n[d.ContentType]=this._getExistingOrDefaultHeader(n,d.ContentType,T.ApplicationJson);let i=await this.patch(e,s,n);return this._processResponse(i,this.requestOptions)}async request(e,r,n,s){if(this._disposed)throw new Error("Client has already been disposed.");let i=new URL(r),a=this._prepareRequest(e,i,s),o=this._allowRetries&&At.indexOf(e)!=-1?this._maxRetries+1:1,l=0,u;for(;l<o;){if(u=await this.requestRaw(a,n),u&&u.message&&u.message.statusCode===y.Unauthorized){let p;for(let h=0;h<this.handlers.length;h++)if(this.handlers[h].canHandleAuthentication(u)){p=this.handlers[h];break}return p?p.handleAuthentication(this,a,n):u}let f=this._maxRedirects;for(;bt.indexOf(u.message.statusCode)!=-1&&this._allowRedirects&&f>0;){let p=u.message.headers.location;if(!p)break;let h=new URL(p);if(i.protocol=="https:"&&i.protocol!=h.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(await u.readBody(),h.hostname!==i.hostname)for(let R in s)R.toLowerCase()==="authorization"&&delete s[R];a=this._prepareRequest(e,h,s),u=await this.requestRaw(a,n),f--}if(Rt.indexOf(u.message.statusCode)==-1)return u;l+=1,l<o&&(await u.readBody(),await this._performExponentialBackoff(l))}return u}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(e,r){return new Promise((n,s)=>{let i=function(a,o){a&&s(a),n(o)};this.requestRawWithCallback(e,r,i)})}requestRawWithCallback(e,r,n){let s;typeof r=="string"&&(e.options.headers["Content-Length"]=Buffer.byteLength(r,"utf8"));let i=!1,a=(l,u)=>{i||(i=!0,n(l,u))},o=e.httpModule.request(e.options,l=>{let u=new H(l);a(null,u)});o.on("socket",l=>{s=l}),o.setTimeout(this._socketTimeout||3*6e4,()=>{s&&s.end(),a(new Error("Request timeout: "+e.options.path),null)}),o.on("error",function(l){a(l,null)}),r&&typeof r=="string"&&o.write(r,"utf8"),r&&typeof r!="string"?(r.on("close",function(){o.end()}),r.pipe(o)):o.end()}getAgent(e){let r=new URL(e);return this._getAgent(r)}_prepareRequest(e,r,n){let s={};s.parsedUrl=r;let i=s.parsedUrl.protocol==="https:";s.httpModule=i?X:j;let a=i?443:80;return s.options={},s.options.host=s.parsedUrl.hostname,s.options.port=s.parsedUrl.port?parseInt(s.parsedUrl.port):a,s.options.path=(s.parsedUrl.pathname||"")+(s.parsedUrl.search||""),s.options.method=e,s.options.headers=this._mergeHeaders(n),this.userAgent!=null&&(s.options.headers["user-agent"]=this.userAgent),s.options.agent=this._getAgent(s.parsedUrl),this.handlers&&this.handlers.forEach(o=>{o.prepareRequest(s.options)}),s}_mergeHeaders(e){let r=n=>Object.keys(n).reduce((s,i)=>(s[i.toLowerCase()]=n[i],s),{});return this.requestOptions&&this.requestOptions.headers?Object.assign({},r(this.requestOptions.headers),r(e)):r(e||{})}_getExistingOrDefaultHeader(e,r,n){let s=a=>Object.keys(a).reduce((o,l)=>(o[l.toLowerCase()]=a[l],o),{}),i;return this.requestOptions&&this.requestOptions.headers&&(i=s(this.requestOptions.headers)[r]),e[r]||i||n}_getAgent(e){let r,n=Oe.getProxyUrl(e),s=n&&n.hostname;if(this._keepAlive&&s&&(r=this._proxyAgent),this._keepAlive&&!s&&(r=this._agent),r)return r;let i=e.protocol==="https:",a=100;if(this.requestOptions&&(a=this.requestOptions.maxSockets||j.globalAgent.maxSockets),s){q||(q=Te());let o={maxSockets:a,keepAlive:this._keepAlive,proxy:k(N({},(n.username||n.password)&&{proxyAuth:`${n.username}:${n.password}`}),{host:n.hostname,port:n.port})},l,u=n.protocol==="https:";i?l=u?q.httpsOverHttps:q.httpsOverHttp:l=u?q.httpOverHttps:q.httpOverHttp,r=l(o),this._proxyAgent=r}if(this._keepAlive&&!r){let o={keepAlive:this._keepAlive,maxSockets:a};r=i?new X.Agent(o):new j.Agent(o),this._agent=r}return r||(r=i?X.globalAgent:j.globalAgent),i&&this._ignoreSslError&&(r.options=Object.assign(r.options||{},{rejectUnauthorized:!1})),r}_performExponentialBackoff(e){e=Math.min(Pt,e);let r=xt*Math.pow(2,e);return new Promise(n=>setTimeout(()=>n(),r))}static dateTimeDeserializer(e,r){if(typeof r=="string"){let n=new Date(r);if(!isNaN(n.valueOf()))return n}return r}async _processResponse(e,r){return new Promise(async(n,s)=>{let i=e.message.statusCode,a={statusCode:i,result:null,headers:{}};i==y.NotFound&&n(a);let o,l;try{l=await e.readBody(),l&&l.length>0&&(r&&r.deserializeDates?o=JSON.parse(l,F.dateTimeDeserializer):o=JSON.parse(l),a.result=o),a.headers=e.message.headers}catch{}if(i>299){let u;o&&o.message?u=o.message:l&&l.length>0?u=l:u="Failed request: ("+i+")";let f=new D(u,i);f.result=a.result,s(f)}else n(a)})}};m.HttpClient=F});var xe=_(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});var Re=class{constructor(e,r){this.username=e,this.password=r}prepareRequest(e){e.headers.Authorization="Basic "+Buffer.from(this.username+":"+this.password).toString("base64")}canHandleAuthentication(e){return!1}handleAuthentication(e,r,n){return null}};M.BasicCredentialHandler=Re;var Ae=class{constructor(e){this.token=e}prepareRequest(e){e.headers.Authorization="Bearer "+this.token}canHandleAuthentication(e){return!1}handleAuthentication(e,r,n){return null}};M.BearerCredentialHandler=Ae;var Pe=class{constructor(e){this.token=e}prepareRequest(e){e.headers.Authorization="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(e){return!1}handleAuthentication(e,r,n){return null}};M.PersonalAccessTokenCredentialHandler=Pe});var Ue=_(I=>{"use strict";var qe=I&&I.__awaiter||function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?i(f.value):s(f.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(I,"__esModule",{value:!0});I.OidcClient=void 0;var It=be(),Ut=xe(),Ie=Z(),b=class{static createHttpClient(e=!0,r=10){let n={allowRetries:e,maxRetries:r};return new It.HttpClient("actions/oidc-client",[new Ut.BearerCredentialHandler(b.getRequestToken())],n)}static getRequestToken(){let e=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return e}static getIDTokenUrl(){let e=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return e}static getCall(e){var r;return qe(this,void 0,void 0,function*(){let i=(r=(yield b.createHttpClient().getJson(e).catch(a=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${a.statusCode}
 
        Error Message: ${a.result.message}`)})).result)===null||r===void 0?void 0:r.value;if(!i)throw new Error("Response json body do not have ID Token field");return i})}static getIDToken(e){return qe(this,void 0,void 0,function*(){try{let r=b.getIDTokenUrl();if(e){let s=encodeURIComponent(e);r=`${r}&audience=${s}`}Ie.debug(`ID token url is ${r}`);let n=yield b.getCall(r);return Ie.setSecret(n),n}catch(r){throw new Error(`Error message: ${r.message}`)}})}};I.OidcClient=b});var Z=_(c=>{"use strict";var Ct=c&&c.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Nt=c&&c.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ce=c&&c.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&Ct(e,t,r);return Nt(e,t),e},Ne=c&&c.__awaiter||function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(f){try{u(n.next(f))}catch(p){a(p)}}function l(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?i(f.value):s(f.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(c,"__esModule",{value:!0});c.getIDToken=c.getState=c.saveState=c.group=c.endGroup=c.startGroup=c.info=c.notice=c.warning=c.error=c.debug=c.isDebug=c.setFailed=c.setCommandEcho=c.setOutput=c.getBooleanInput=c.getMultilineInput=c.getInput=c.addPath=c.setSecret=c.exportVariable=c.ExitCode=void 0;var v=pe(),ke=me(),V=L(),G=Ce(require("os")),kt=Ce(require("path")),Dt=Ue(),De;(function(t){t[t.Success=0]="Success",t[t.Failure=1]="Failure"})(De=c.ExitCode||(c.ExitCode={}));function Mt(t,e){let r=V.toCommandValue(e);if(process.env[t]=r,process.env.GITHUB_ENV||""){let s="_GitHubActionsFileCommandDelimeter_",i=`${t}<<${s}${G.EOL}${r}${G.EOL}${s}`;ke.issueCommand("ENV",i)}else v.issueCommand("set-env",{name:t},r)}c.exportVariable=Mt;function Bt(t){v.issueCommand("add-mask",{},t)}c.setSecret=Bt;function Lt(t){process.env.GITHUB_PATH||""?ke.issueCommand("PATH",t):v.issueCommand("add-path",{},t),process.env.PATH=`${t}${kt.delimiter}${process.env.PATH}`}c.addPath=Lt;function ee(t,e){let r=process.env[`INPUT_${t.replace(/ /g,"_").toUpperCase()}`]||"";if(e&&e.required&&!r)throw new Error(`Input required and not supplied: ${t}`);return e&&e.trimWhitespace===!1?r:r.trim()}c.getInput=ee;function $t(t,e){return ee(t,e).split(`
`).filter(n=>n!=="")}c.getMultilineInput=$t;function jt(t,e){let r=["true","True","TRUE"],n=["false","False","FALSE"],s=ee(t,e);if(r.includes(s))return!0;if(n.includes(s))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${t}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}c.getBooleanInput=jt;function Ft(t,e){process.stdout.write(G.EOL),v.issueCommand("set-output",{name:t},e)}c.setOutput=Ft;function Vt(t){v.issue("echo",t?"on":"off")}c.setCommandEcho=Vt;function Gt(t){process.exitCode=De.Failure,Me(t)}c.setFailed=Gt;function Jt(){return process.env.RUNNER_DEBUG==="1"}c.isDebug=Jt;function zt(t){v.issueCommand("debug",{},t)}c.debug=zt;function Me(t,e={}){v.issueCommand("error",V.toCommandProperties(e),t instanceof Error?t.toString():t)}c.error=Me;function Kt(t,e={}){v.issueCommand("warning",V.toCommandProperties(e),t instanceof Error?t.toString():t)}c.warning=Kt;function Yt(t,e={}){v.issueCommand("notice",V.toCommandProperties(e),t instanceof Error?t.toString():t)}c.notice=Yt;function Wt(t){process.stdout.write(t+G.EOL)}c.info=Wt;function Be(t){v.issue("group",t)}c.startGroup=Be;function Le(){v.issue("endgroup")}c.endGroup=Le;function Qt(t,e){return Ne(this,void 0,void 0,function*(){Be(t);let r;try{r=yield e()}finally{Le()}return r})}c.group=Qt;function Xt(t,e){v.issueCommand("save-state",{name:t},e)}c.saveState=Xt;function Ht(t){return process.env[`STATE_${t}`]||""}c.getState=Ht;function Zt(t){return Ne(this,void 0,void 0,function*(){return yield Dt.OidcClient.getIDToken(t)})}c.getIDToken=Zt});var O=A(Z());var Y=A(require("fs"));var U=A(require("node:path"),1);var je=A(require("node:process"),1),Fe=A(require("node:path"),1),K=A(require("node:fs"),1);var $e=class{value;next;constructor(e){this.value=e}},J=class{#e;#t;#r;constructor(){this.clear()}enqueue(e){let r=new $e(e);this.#e?(this.#t.next=r,this.#t=r):(this.#e=r,this.#t=r),this.#r++}dequeue(){let e=this.#e;if(!!e)return this.#e=this.#e.next,this.#r--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}};function z(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");let e=new J,r=0,n=()=>{r--,e.size>0&&e.dequeue()()},s=async(o,l,u)=>{r++;let f=(async()=>o(...u))();l(f);try{await f}catch{}n()},i=(o,l,u)=>{e.enqueue(s.bind(void 0,o,l,u)),(async()=>(await Promise.resolve(),r<t&&e.size>0&&e.dequeue()()))()},a=(o,...l)=>new Promise(u=>{i(o,u,l)});return Object.defineProperties(a,{activeCount:{get:()=>r},pendingCount:{get:()=>e.size},clearQueue:{value:()=>{e.clear()}}}),a}var te=class extends Error{constructor(e){super();this.value=e}},er=async(t,e)=>e(await t),tr=async t=>{let e=await Promise.all(t);if(e[1]===!0)throw new te(e[0]);return!1};async function re(t,e,{concurrency:r=Number.POSITIVE_INFINITY,preserveOrder:n=!0}={}){let s=z(r),i=[...t].map(o=>[o,s(er,o,e)]),a=z(n?1:Number.POSITIVE_INFINITY);try{await Promise.all(i.map(o=>a(tr,o)))}catch(o){if(o instanceof te)return o.value;throw o}}var Ve={directory:"isDirectory",file:"isFile"};function rr(t){if(!(t in Ve))throw new Error(`Invalid type specified: ${t}`)}var nr=(t,e)=>t===void 0||e[Ve[t]]();async function ne(t,{cwd:e=je.default.cwd(),type:r="file",allowSymlinks:n=!0,concurrency:s,preserveOrder:i}={}){rr(r);let a=n?K.promises.stat:K.promises.lstat;return re(t,async o=>{try{let l=await a(Fe.default.resolve(e,o));return nr(r,l)}catch{return!1}},{concurrency:s,preserveOrder:i})}var sr=Symbol("findUpStop");async function ir(t,e={}){let r=U.default.resolve(e.cwd||""),{root:n}=U.default.parse(r),s=U.default.resolve(r,e.stopAt||n),i=e.limit||Number.POSITIVE_INFINITY,a=[t].flat(),o=async u=>{if(typeof t!="function")return ne(a,u);let f=await t(u.cwd);return typeof f=="string"?ne([f],u):f},l=[];for(;;){let u=await o(k(N({},e),{cwd:r}));if(u===sr||(u&&l.push(U.default.resolve(r,u)),r===s||l.length>=i))break;r=U.default.dirname(r)}return l}async function Ge(t,e={}){return(await ir(t,k(N({},e),{limit:1})))[0]}var Je=require("fs");async function se(t,e){let r=await Ge(e,{cwd:t});if(!r)throw new Error(`Could not find ${e} in folder or parents`);return(0,Je.readFileSync)(r,"utf-8").trim()}async function ze({terraformRoot:t}){let e=await se(t,".terraform-version"),r=await se(t,".terragrunt-version"),n=[],s=!1;if(Y.existsSync(`${t}/terragrunt.hcl`)){s=!0;let i=Y.readFileSync(`${t}/terragrunt.hcl`,"utf8");n=or(i)}return{tfVersion:e,tgVersion:r,tgDependencies:n,isTerragruntModule:s}}function or(t){return t.split(`
`).map(e=>e.match(/^\s*config_path\s+?=\s+?"(.+?)"/)).filter(e=>Boolean(e)).map(([,e])=>e)}async function ar(){try{let t=O.getInput("cwd"),{tfVersion:e,tgDependencies:r,tgVersion:n}=await ze({terraformRoot:t});O.setOutput("tf_version",e),O.setOutput("tg_version",n),O.setOutput("tg_dependencies",r)}catch(t){O.setFailed(t)}}ar();
